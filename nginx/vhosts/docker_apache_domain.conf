<VirtualHost *:80>
    ServerName <DOMAIN_NAME>
    ServerAlias www.<DOMAIN_NAME>
    DocumentRoot /home/<USER>/<DOMAIN_NAME>
    CustomLog /var/log/apache2/domlogs/<DOMAIN_NAME>.log combined

    ##### /phmyadmin on #####
    ProxyRequests Off
    ProxyPreserveHost On

    <Proxy>
        Require all granted
    </Proxy>

    ProxyPass /phpmyadmin http://localhost:8080/
    ProxyPassReverse /phpmyadmin http://localhost:8080/

    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Ssl on
    ##### /phpmyadmin end #####

    <Directory /home/<USER>/<DOMAIN_NAME>>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    DirectoryIndex index.php index.html

    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php/<PHP>-fpm.sock|fcgi://localhost"
    </FilesMatch>

    <DirectoryMatch "^/.*/\..*">
        Order Deny,Allow
        Deny from all
    </DirectoryMatch>

</VirtualHost>


<VirtualHost *:443>
    ServerName <DOMAIN_NAME>
    ServerAlias www.<DOMAIN_NAME>
    DocumentRoot /home/<USER>/<DOMAIN_NAME>
    CustomLog /var/log/apache2/domlogs/<DOMAIN_NAME>.log combined

    SSLEngine on
    SSLCertificateFile /etc/apache2/ssl/cert.crt
    SSLCertificateKeyFile /etc/apache2/ssl/cert.key

    ##### /phmyadmin on #####
    ProxyRequests Off
    ProxyPreserveHost On

    <Proxy>
        Require all granted
    </Proxy>

    ProxyPass /phpmyadmin http://localhost:8080/
    ProxyPassReverse /phpmyadmin http://localhost:8080/

    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Ssl on
    ##### /phpmyadmin end #####

    <Directory /home/<USER>/<DOMAIN_NAME>>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    DirectoryIndex index.php index.html

    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php/<PHP>-fpm.sock|fcgi://localhost"
    </FilesMatch>

    <DirectoryMatch "^/.*/\..*">
        Order Deny,Allow
        Deny from all
    </DirectoryMatch>
</VirtualHost>
